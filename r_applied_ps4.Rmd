---
title: "applied_PS4"
author: "Zara"
date: "13th May 2023"
output: pdf_document
---
<!-- .Rmd files use  markdown, a text mark up language, to provide formating.-->

<!--Text include within these strange arrows are comments and will not show up when you knit-->

# Front matter

This submission is my work alone and complies with the 30535 integrity policy.

Add your initials to indicate your agreement: \<\<\_\>\>

Upload your collaborators here: https://forms.gle/3mH1ofZZj9ZCgBHb8

Late coins used this pset: 0. Late coins left: 4. <!--You may use one for a given assignment.-->


```{r message=FALSE, warning=FALSE}
rm(list=ls())
install.packages("anytime")
install.packages("bigrquery")
install.packages("stringr")
library(bigrquery)
library(tidyverse)
library(testthat)
library(ggplot2)
library(dplyr)
library(lubridate)
rm(list=ls())
install.packages("readr")
library(readr)
dfw<- read_rds("waze_data.rds")

```


## 5 Data Cleaning 
5.1 
```{r}
test_that(
  "we have the right number of row",
  expect_equal(nrow(dfw),737357))

```
5.2 The data covers the city of chicago 
```{r}

city_number<-dfw|>
  distinct(city)|>
  print()
```
5.3 Separate columns for longitude and latitude created. 
```{r}
dfw <- dfw |>
  mutate(longitude = as.numeric(str_extract(geo, "-?\\d+\\.\\d+(?=\\s)")),
         latitude = as.numeric(str_extract(geo, "(?<=\\s)-?\\d+\\.\\d+")))|>
  relocate(longitude, latitude)|>
  print()



```
5.4 Alerts are most common at night post fromn 20:00 hours to 22:00 hours.

```{r}

library(ggplot2)
library(dplyr)
library(lubridate)

dfw <- dfw |>
  mutate(hour = hour(ymd_hms(ts)))

ggplot(dfw, aes(x = hour, fill = type)) +
  geom_bar() +
  labs(x = "Hour of Day", y = "Number of Alerts", fill = "Alert Type") +
  ggtitle("Number of Alerts by Hour of Day") +
  theme_minimal()+ 
  scale_x_continuous(breaks = seq(0, 23, by = 1))+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

5.5 The alerts are in central time zones , 
```{r}
dfw <- dfw |>
  mutate(
    ts = as.POSIXct(ts, format = "%Y-%m-%d %H:%M:%S", tz = "UTC"),
    ts_ct = with_tz(ts, "America/Chicago"),
    ts_ct_rounded = round_date(ts_ct, "5 minutes")
  )


```

6.1 

# R for Data Science Exercises

<!--Note: Please do not restate questions in your submissions, directly write your answer--->

## First Section

<!--(Notice the use of two `##`)-->

1.  YOUR TEXT ANSWER GOES HERE (Please delete)

-   The dash symbol creates unordered list

-   Another example

    1.  numbering creates ordered list
    2.  Another example

    -   like This
    -   Like this as well

**Delete all the text in `1.` before you write your answer**

```{r}
# YOUR CODE GOES HERE  (Please delete)
ggplot(mpg, aes(manufacturer)) + geom_bar()
```


## Second Section

1.  YOUR TEXT ANSWER GOES HERE (Please delete)

```{r}
# YOUR CODE GOES HERE  (Please delete)
ggplot(mtcars, aes(factor(cyl), mpg)) + geom_violin(aes(fill=mpg))
```

